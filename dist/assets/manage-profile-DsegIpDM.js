import{k as G,r as u,o as H,n as J,q as K,v as l,i as e,A as r,X as c,z as g,$ as S}from"./index-XfzghrTN.js";import{u as O}from"./useAuth-CpsKkO3P.js";import Q from"./useNotify-CNR52NHZ.js";import{b as D}from"./route-block-B_A1xBdJ.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as F,a as L,b as P,c as b,d as y}from"./VCard-BECKUIfU.js";import{V as Y,b as Z}from"./VToolbar-CJTxx6En.js";import{V as h}from"./VSpacer-DV0-RfCV.js";import{V as ee}from"./VContainer-R6qPkMgO.js";import{V as ae,a as _,c as x,e as C}from"./VList-uSYSyOiG.js";import{V as k}from"./VForm-D4DxYAg7.js";import{V as i}from"./VTextField-DrQV8GZt.js";import{V as I}from"./VBtn-DyMKmmJZ.js";import{V as le}from"./VSheet-Braltggs.js";import"./VAvatar-DrNrBBh9.js";import"./dimensions-BTn1Zqj3.js";import"./index-CT5Z8H4E.js";import"./ssrBoot-CEib-DlM.js";import"./forwardRefs--s6B5EbG.js";const R={__name:"manage-profile",setup(te){G(),Q();const{currentUser:m,updateUserEmail:A,updateUserPassword:M}=O();u(null);const f=u(null),E=u(null),U=u(null),w=u(!1),p=u(!1),v=u(!1),V=u(!1),n=u({newEmail:"",currentPassword:""}),o=u({currentPassword:"",newPassword:"",confirmPassword:""}),q={title:"Manage Profile"},B=[t=>!!t||"Email is required",t=>/.+@.+\..+/.test(t)||"Email must be valid",t=>{var a;return t!==((a=m.value)==null?void 0:a.email)||"New email must be different from current email"}],N=[t=>!!t||"Password is required"],z=[t=>!!t||"New password is required",t=>t.length>=6||"Password must be at least 6 characters"],X=[t=>!!t||"Please confirm your password",t=>t===o.value.newPassword||"Passwords do not match"],T=t=>{if(!t)return"Not available";try{return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Not available"}},$=async()=>{if(!w.value)return;v.value=!0;const t=await A(n.value.newEmail,n.value.currentPassword);v.value=!1,t.success&&(n.value.newEmail="",n.value.currentPassword="",E.value.reset())},j=async()=>{if(!p.value)return;V.value=!0;const t=await M(o.value.currentPassword,o.value.newPassword);V.value=!1,t.success&&(o.value.currentPassword="",o.value.newPassword="",o.value.confirmPassword="",U.value.reset())};return H(()=>{var t;f.value=q,(t=f.value)!=null&&t.title&&(document.title=f.value.title)}),(t,a)=>(K(),J(le,{class:"flex-grow-1 d-flex flex-column",flat:"",rounded:"",color:"transparent"},{default:l(()=>[e(F,{class:"flex-grow-1 ma-0"},{default:l(()=>[e(L,{class:"d-flex flex-column pa-0"},{default:l(()=>[e(P,{class:"flex-grow-1 d-flex flex-column",flat:""},{default:l(()=>[e(Y,{color:"primary",dark:"",flat:"",density:"compact"},{default:l(()=>[e(Z,null,{default:l(()=>{var s;return[r(c(((s=f.value)==null?void 0:s.title)||"Manage Profile"),1)]}),_:1}),e(h)]),_:1}),e(b,{class:"flex-grow-1",style:{"overflow-y":"auto"}},{default:l(()=>[e(ee,null,{default:l(()=>[e(F,null,{default:l(()=>[e(L,{cols:"12",md:"8",lg:"6"},{default:l(()=>[e(P,{class:"mb-6",variant:"outlined"},{default:l(()=>[e(y,null,{default:l(()=>[...a[7]||(a[7]=[r("Account Information",-1)])]),_:1}),e(b,null,{default:l(()=>[e(ae,null,{default:l(()=>[e(_,null,{default:l(()=>[e(x,null,{default:l(()=>[...a[8]||(a[8]=[r("Email",-1)])]),_:1}),e(C,null,{default:l(()=>{var s;return[r(c(((s=g(m))==null?void 0:s.email)||"Not available"),1)]}),_:1})]),_:1}),e(_,null,{default:l(()=>[e(x,null,{default:l(()=>[...a[9]||(a[9]=[r("Account Created",-1)])]),_:1}),e(C,null,{default:l(()=>{var s,d;return[r(c(T((d=(s=g(m))==null?void 0:s.metadata)==null?void 0:d.creationTime)),1)]}),_:1})]),_:1}),e(_,null,{default:l(()=>[e(x,null,{default:l(()=>[...a[10]||(a[10]=[r("Last Sign In",-1)])]),_:1}),e(C,null,{default:l(()=>{var s,d;return[r(c(T((d=(s=g(m))==null?void 0:s.metadata)==null?void 0:d.lastSignInTime)),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(P,{class:"mb-6",variant:"outlined"},{default:l(()=>[e(y,null,{default:l(()=>[...a[11]||(a[11]=[r("Change Email",-1)])]),_:1}),e(b,null,{default:l(()=>[e(k,{ref_key:"emailForm",ref:E,modelValue:w.value,"onUpdate:modelValue":a[2]||(a[2]=s=>w.value=s),onSubmit:S($,["prevent"])},{default:l(()=>[e(i,{modelValue:n.value.newEmail,"onUpdate:modelValue":a[0]||(a[0]=s=>n.value.newEmail=s),label:"New Email Address",type:"email",rules:B,variant:"outlined",class:"mb-3"},null,8,["modelValue"]),e(i,{modelValue:n.value.currentPassword,"onUpdate:modelValue":a[1]||(a[1]=s=>n.value.currentPassword=s),label:"Current Password",type:"password",rules:N,variant:"outlined",class:"mb-3"},null,8,["modelValue"]),e(I,{type:"submit",color:"primary",loading:v.value,disabled:!w.value||v.value},{default:l(()=>[...a[12]||(a[12]=[r(" Update Email ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(P,{variant:"outlined"},{default:l(()=>[e(y,null,{default:l(()=>[...a[13]||(a[13]=[r("Change Password",-1)])]),_:1}),e(b,null,{default:l(()=>[e(k,{ref_key:"passwordForm",ref:U,modelValue:p.value,"onUpdate:modelValue":a[6]||(a[6]=s=>p.value=s),onSubmit:S(j,["prevent"])},{default:l(()=>[e(i,{modelValue:o.value.currentPassword,"onUpdate:modelValue":a[3]||(a[3]=s=>o.value.currentPassword=s),label:"Current Password",type:"password",rules:N,variant:"outlined",class:"mb-3"},null,8,["modelValue"]),e(i,{modelValue:o.value.newPassword,"onUpdate:modelValue":a[4]||(a[4]=s=>o.value.newPassword=s),label:"New Password",type:"password",rules:z,variant:"outlined",class:"mb-3"},null,8,["modelValue"]),e(i,{modelValue:o.value.confirmPassword,"onUpdate:modelValue":a[5]||(a[5]=s=>o.value.confirmPassword=s),label:"Confirm New Password",type:"password",rules:X,variant:"outlined",class:"mb-3"},null,8,["modelValue"]),e(I,{type:"submit",color:"primary",loading:V.value,disabled:!p.value||V.value},{default:l(()=>[...a[14]||(a[14]=[r(" Update Password ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};typeof D=="function"&&D(R);const xe=W(R,[["__scopeId","data-v-8e6d801d"]]);export{xe as default};
