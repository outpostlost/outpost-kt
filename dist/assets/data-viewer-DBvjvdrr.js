import{Z,r as o,c as G,o as H,n as B,q as T,v as a,i as e,A as f,x as Q,y as W,B as Y,N as E,X as ee}from"./index-XfzghrTN.js";import le from"./useNotify-CNR52NHZ.js";import{b as F}from"./route-block-B_A1xBdJ.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{k as te,i as oe}from"./VAvatar-DrNrBBh9.js";import{V as v,a as u,b as w,c as x,d as U}from"./VCard-BECKUIfU.js";import{V as re}from"./VContainer-R6qPkMgO.js";import{V as j}from"./VSelect-7OPIFvbh.js";import{V as R}from"./VTextField-DrQV8GZt.js";import{V as k}from"./VBtn-DyMKmmJZ.js";import{d as ne}from"./VList-uSYSyOiG.js";import{V as ue,b as se}from"./VToolbar-CJTxx6En.js";import{V as ie}from"./VSpacer-DV0-RfCV.js";import{V as ce}from"./VTextarea-kSkycfnj.js";import{V as de}from"./VSheet-Braltggs.js";import"./dimensions-BTn1Zqj3.js";import"./forwardRefs--s6B5EbG.js";import"./index-CT5Z8H4E.js";import"./VOverlay-CuvIps3-.js";import"./scopeId-JKcj2l0q.js";import"./lazy-CW5rMfy1.js";import"./VSelectionControl-CgJ3t_n0.js";import"./VChip-CdDlcFnE.js";import"./ssrBoot-CEib-DlM.js";const me=te("v-code","code"),fe={key:1,class:"text-center pa-4 text-grey-lighten-1"},$={__name:"data-viewer",setup(ve){Z();const n=le();o(null);const C=o(null),z={title:"Data Viewer"},A=o([{label:"Business Data",value:"bizData"},{label:"Business Trends",value:"bizTrends"},{label:"Operational",value:"operational"},{label:"Audit",value:"audit"}]),p=o(""),s=o(""),y=o(""),g=o(null),d=o(!1),J=o(!1),P=o(!1),_=o([]),m=o(""),i=o(""),b=o(""),V=o(""),c=o(!1),N=o(!1),D=o([]),S=G(()=>g.value?JSON.stringify(g.value,null,2):""),L=async t=>{try{await multiProjectDAL.switchToProject("operational");const r=(await multiProjectDAL.getAllItems("collections")).find(I=>I.projectId===t);return r&&r.collections?r.collections.map(h=>({label:h.collectionLabel,value:h.collectionName})):(n.warning(`No collections metadata found for project: ${t}`),[])}catch(l){return console.error("Error loading collections:",l),n.error(`Failed to load collections for project: ${t}`),[]}},K=async t=>{if(!t){_.value=[],s.value="";return}P.value=!0,s.value="";try{_.value=await L(t)}finally{P.value=!1}},M=async t=>{if(!t){D.value=[],i.value="";return}N.value=!0,i.value="";try{D.value=await L(t)}finally{N.value=!1}},O=async()=>{if(!p.value||!s.value||!y.value){n.warning("Please select project, collection, and enter document ID.");return}d.value=!0,g.value=null;try{await multiProjectDAL.switchToProject(p.value);const t=await multiProjectDAL.getItemById(s.value,y.value);t?(g.value=t,n.success("Document loaded successfully.")):n.error(`Document not found in '${s.value}' with ID '${y.value}'.`)}catch(t){console.error("Error fetching document:",t),n.error(t.message||"An unexpected error occurred while fetching the document.")}finally{try{await multiProjectDAL.switchToProject("operational")}catch(t){console.error("Error switching back to operational:",t)}d.value=!1}},q=async()=>{if(!S.value){n.warning("There is no data to copy.");return}try{await navigator.clipboard.writeText(S.value),n.info("JSON copied to clipboard.")}catch(t){console.error("Failed to copy text: ",t),n.error("Failed to copy JSON to clipboard.")}},X=async()=>{if(!m.value||!i.value||!b.value||!V.value){n.warning("Please provide project, collection, ID, and JSON content.");return}c.value=!0;let t;try{t=JSON.parse(V.value)}catch(l){console.error("JSON Parsing Error:",l),n.error("Invalid JSON format. Please check the syntax and try again."),c.value=!1;return}try{await multiProjectDAL.switchToProject(m.value),await multiProjectDAL.setItem(i.value,b.value,t,!1),n.success("Document replaced successfully."),m.value="",i.value="",b.value="",V.value="",D.value=[]}catch(l){console.error("Error replacing document:",l),n.error(l.message||"An unexpected error occurred while replacing the document.")}finally{try{await multiProjectDAL.switchToProject("operational")}catch(l){console.error("Error switching back to operational:",l)}c.value=!1}};return H(()=>{var t;C.value=z,(t=C.value)!=null&&t.title&&(document.title=C.value.title)}),(t,l)=>(T(),B(de,{class:"flex-grow-1 d-flex flex-column",flat:"",rounded:"",color:"surface"},{default:a(()=>[e(v,{class:"flex-grow-1 ma-0"},{default:a(()=>[e(u,{class:"d-flex flex-column pa-0"},{default:a(()=>[e(w,{class:"bg-sand flex-grow-1 d-flex flex-column",flat:"",border:0},{default:a(()=>[e(x,{class:"flex-grow-1",style:{"overflow-y":"auto"},border:0},{default:a(()=>[e(re,{fluid:""},{default:a(()=>[e(v,null,{default:a(()=>[e(u,{cols:"12"},{default:a(()=>[e(w,{class:"bg-surface",variant:"outlined"},{default:a(()=>[e(U,{class:"text-secondary"},{default:a(()=>[...l[7]||(l[7]=[f("Firestore Document Viewer",-1)])]),_:1}),e(x,null,{default:a(()=>[e(v,null,{default:a(()=>[e(u,{cols:"12",md:"4"},{default:a(()=>[e(j,{modelValue:p.value,"onUpdate:modelValue":[l[0]||(l[0]=r=>p.value=r),K],items:A.value,"item-title":"label","item-value":"value",label:"Project",variant:"outlined",density:"compact",disabled:d.value||J.value},null,8,["modelValue","items","disabled"])]),_:1}),e(u,{cols:"12",md:"4"},{default:a(()=>[e(j,{modelValue:s.value,"onUpdate:modelValue":l[1]||(l[1]=r=>s.value=r),items:_.value,"item-title":"label","item-value":"value",label:"Collection",variant:"outlined",density:"compact",disabled:d.value||!p.value||P.value,"no-data-text":"Select a project first"},null,8,["modelValue","items","disabled"])]),_:1}),e(u,{cols:"12",md:"4"},{default:a(()=>[e(R,{modelValue:y.value,"onUpdate:modelValue":l[2]||(l[2]=r=>y.value=r),label:"Document ID",variant:"outlined",density:"compact",disabled:d.value,onKeyup:Y(O,["enter"])},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(v,null,{default:a(()=>[e(u,{cols:"12",class:"d-flex justify-end"},{default:a(()=>[e(k,{color:"primary",onClick:O,loading:d.value,disabled:!p.value||!s.value||!y.value},{default:a(()=>[...l[8]||(l[8]=[f(" Fetch Document ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),e(ne,{class:"my-4"}),g.value?(T(),B(w,{key:0,class:"bg-surface",variant:"outlined"},{default:a(()=>[e(ue,{flat:"",color:"transparent"},{default:a(()=>[e(se,{class:"text-secondary"},{default:a(()=>[...l[9]||(l[9]=[f("Document Data",-1)])]),_:1}),e(ie),e(k,{color:"secondary",onClick:q,"prepend-icon":"mdi-content-copy"},{default:a(()=>[...l[10]||(l[10]=[f(" Copy JSON ",-1)])]),_:1})]),_:1}),e(x,null,{default:a(()=>[e(w,{variant:"outlined"},{default:a(()=>[e(me,{tag:"pre",class:"pa-4"},{default:a(()=>[E("code",null,ee(S.value),1)]),_:1})]),_:1})]),_:1})]),_:1})):d.value?W("",!0):(T(),Q("div",fe,[e(oe,{size:"48"},{default:a(()=>[...l[11]||(l[11]=[f("mdi-text-box-search-outline",-1)])]),_:1}),l[12]||(l[12]=E("p",{class:"mt-2"},"Select project, collection, and ID to fetch a document.",-1))]))]),_:1})]),_:1})]),_:1})]),_:1}),e(v,null,{default:a(()=>[e(u,{cols:"12"},{default:a(()=>[e(w,{class:"bg-surface",variant:"outlined"},{default:a(()=>[e(U,{class:"text-secondary"},{default:a(()=>[...l[13]||(l[13]=[f("Replace Document Content",-1)])]),_:1}),e(x,null,{default:a(()=>[e(v,null,{default:a(()=>[e(u,{cols:"12",md:"4"},{default:a(()=>[e(j,{modelValue:m.value,"onUpdate:modelValue":[l[3]||(l[3]=r=>m.value=r),M],items:A.value,"item-title":"label","item-value":"value",label:"Project",variant:"outlined",density:"compact",disabled:c.value||J.value},null,8,["modelValue","items","disabled"])]),_:1}),e(u,{cols:"12",md:"4"},{default:a(()=>[e(j,{modelValue:i.value,"onUpdate:modelValue":l[4]||(l[4]=r=>i.value=r),items:D.value,"item-title":"label","item-value":"value",label:"Collection",variant:"outlined",density:"compact",disabled:c.value||!m.value||N.value,"no-data-text":"Select a project first"},null,8,["modelValue","items","disabled"])]),_:1}),e(u,{cols:"12",md:"4"},{default:a(()=>[e(R,{modelValue:b.value,"onUpdate:modelValue":l[5]||(l[5]=r=>b.value=r),label:"Document ID",variant:"outlined",density:"compact",disabled:c.value},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(ce,{modelValue:V.value,"onUpdate:modelValue":l[6]||(l[6]=r=>V.value=r),label:"New JSON Content",variant:"outlined",rows:"10","auto-grow":"",disabled:c.value,placeholder:'{ "key": "value", "anotherKey": true }'},null,8,["modelValue","disabled"]),e(v,null,{default:a(()=>[e(u,{cols:"12",class:"d-flex justify-end"},{default:a(()=>[e(k,{color:"primary",onClick:X,loading:c.value,disabled:!m.value||!i.value||!b.value||!V.value},{default:a(()=>[...l[14]||(l[14]=[f(" Replace Document ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};typeof F=="function"&&F($);const Fe=ae($,[["__scopeId","data-v-fa63505a"]]);export{Fe as default};
