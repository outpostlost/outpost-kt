import{k as K,r as u,o as O,n as Q,q as W,v as l,i as e,A as o,X as c,z as g,$ as S}from"./index-XfzghrTN.js";import{u as Y}from"./useAuth-CpsKkO3P.js";import Z from"./useNotify-CNR52NHZ.js";import{b as k}from"./route-block-B_A1xBdJ.js";import{_ as h}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as D,a as F,b as P,c as b,d as y}from"./VCard-BECKUIfU.js";import{V as ee,b as ae}from"./VToolbar-CJTxx6En.js";import{V as le}from"./VSpacer-DV0-RfCV.js";import{V as x}from"./VBtn-DyMKmmJZ.js";import{V as te}from"./VContainer-R6qPkMgO.js";import{V as se,a as _,c as C,e as U}from"./VList-uSYSyOiG.js";import{V as I}from"./VForm-D4DxYAg7.js";import{V as i}from"./VTextField-DrQV8GZt.js";import{V as oe}from"./VSheet-Braltggs.js";import"./VAvatar-DrNrBBh9.js";import"./dimensions-BTn1Zqj3.js";import"./index-CT5Z8H4E.js";import"./ssrBoot-CEib-DlM.js";import"./forwardRefs--s6B5EbG.js";const R={__name:"profile",setup(re){const A=K();Z();const{currentUser:m,updateUserEmail:q,updateUserPassword:B,logoutUser:M}=Y();u(null);const f=u(null),E=u(null),N=u(null),w=u(!1),p=u(!1),v=u(!1),V=u(!1),n=u({newEmail:"",currentPassword:""}),r=u({currentPassword:"",newPassword:"",confirmPassword:""}),z={title:"Profile"},X=[t=>!!t||"Email is required",t=>/.+@.+\..+/.test(t)||"Email must be valid",t=>{var a;return t!==((a=m.value)==null?void 0:a.email)||"New email must be different from current email"}],L=[t=>!!t||"Password is required"],$=[t=>!!t||"New password is required",t=>t.length>=6||"Password must be at least 6 characters"],j=[t=>!!t||"Please confirm your password",t=>t===r.value.newPassword||"Passwords do not match"],T=t=>{if(!t)return"Not available";try{return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Not available"}},G=async()=>{if(!w.value)return;v.value=!0;const t=await q(n.value.newEmail,n.value.currentPassword);v.value=!1,t.success&&(n.value.newEmail="",n.value.currentPassword="",E.value.reset())},H=async()=>{if(!p.value)return;V.value=!0;const t=await B(r.value.currentPassword,r.value.newPassword);V.value=!1,t.success&&(r.value.currentPassword="",r.value.newPassword="",r.value.confirmPassword="",N.value.reset())},J=async()=>{(await M()).success&&A.replace("/login")};return O(()=>{var t;f.value=z,(t=f.value)!=null&&t.title&&(document.title=f.value.title)}),(t,a)=>(W(),Q(oe,{class:"flex-grow-1 d-flex flex-column",flat:"",rounded:"",color:"transparent"},{default:l(()=>[e(D,{class:"flex-grow-1 ma-0"},{default:l(()=>[e(F,{class:"d-flex flex-column pa-0"},{default:l(()=>[e(P,{class:"flex-grow-1 d-flex flex-column",flat:""},{default:l(()=>[e(ee,{color:"primary",dark:"",flat:"",density:"compact"},{default:l(()=>[e(ae,null,{default:l(()=>{var s;return[o(c(((s=f.value)==null?void 0:s.title)||"Profile"),1)]}),_:1}),e(le),e(x,{variant:"text",onClick:J},{default:l(()=>[...a[7]||(a[7]=[o(" Logout ",-1)])]),_:1})]),_:1}),e(b,{class:"flex-grow-1",style:{"overflow-y":"auto"}},{default:l(()=>[e(te,null,{default:l(()=>[e(D,null,{default:l(()=>[e(F,{cols:"12",md:"8",lg:"6"},{default:l(()=>[e(P,{class:"mb-6",variant:"outlined"},{default:l(()=>[e(y,null,{default:l(()=>[...a[8]||(a[8]=[o("Account Information",-1)])]),_:1}),e(b,null,{default:l(()=>[e(se,null,{default:l(()=>[e(_,null,{default:l(()=>[e(C,null,{default:l(()=>[...a[9]||(a[9]=[o("Email",-1)])]),_:1}),e(U,null,{default:l(()=>{var s;return[o(c(((s=g(m))==null?void 0:s.email)||"Not available"),1)]}),_:1})]),_:1}),e(_,null,{default:l(()=>[e(C,null,{default:l(()=>[...a[10]||(a[10]=[o("Account Created",-1)])]),_:1}),e(U,null,{default:l(()=>{var s,d;return[o(c(T((d=(s=g(m))==null?void 0:s.metadata)==null?void 0:d.creationTime)),1)]}),_:1})]),_:1}),e(_,null,{default:l(()=>[e(C,null,{default:l(()=>[...a[11]||(a[11]=[o("Last Sign In",-1)])]),_:1}),e(U,null,{default:l(()=>{var s,d;return[o(c(T((d=(s=g(m))==null?void 0:s.metadata)==null?void 0:d.lastSignInTime)),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(P,{class:"mb-6",variant:"outlined"},{default:l(()=>[e(y,null,{default:l(()=>[...a[12]||(a[12]=[o("Change Email",-1)])]),_:1}),e(b,null,{default:l(()=>[e(I,{ref_key:"emailForm",ref:E,modelValue:w.value,"onUpdate:modelValue":a[2]||(a[2]=s=>w.value=s),onSubmit:S(G,["prevent"])},{default:l(()=>[e(i,{modelValue:n.value.newEmail,"onUpdate:modelValue":a[0]||(a[0]=s=>n.value.newEmail=s),label:"New Email Address",type:"email",rules:X,variant:"outlined",class:"mb-3"},null,8,["modelValue"]),e(i,{modelValue:n.value.currentPassword,"onUpdate:modelValue":a[1]||(a[1]=s=>n.value.currentPassword=s),label:"Current Password",type:"password",rules:L,variant:"outlined",class:"mb-3"},null,8,["modelValue"]),e(x,{type:"submit",color:"primary",loading:v.value,disabled:!w.value||v.value},{default:l(()=>[...a[13]||(a[13]=[o(" Update Email ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(P,{variant:"outlined"},{default:l(()=>[e(y,null,{default:l(()=>[...a[14]||(a[14]=[o("Change Password",-1)])]),_:1}),e(b,null,{default:l(()=>[e(I,{ref_key:"passwordForm",ref:N,modelValue:p.value,"onUpdate:modelValue":a[6]||(a[6]=s=>p.value=s),onSubmit:S(H,["prevent"])},{default:l(()=>[e(i,{modelValue:r.value.currentPassword,"onUpdate:modelValue":a[3]||(a[3]=s=>r.value.currentPassword=s),label:"Current Password",type:"password",rules:L,variant:"outlined",class:"mb-3"},null,8,["modelValue"]),e(i,{modelValue:r.value.newPassword,"onUpdate:modelValue":a[4]||(a[4]=s=>r.value.newPassword=s),label:"New Password",type:"password",rules:$,variant:"outlined",class:"mb-3"},null,8,["modelValue"]),e(i,{modelValue:r.value.confirmPassword,"onUpdate:modelValue":a[5]||(a[5]=s=>r.value.confirmPassword=s),label:"Confirm New Password",type:"password",rules:j,variant:"outlined",class:"mb-3"},null,8,["modelValue"]),e(x,{type:"submit",color:"primary",loading:V.value,disabled:!p.value||V.value},{default:l(()=>[...a[15]||(a[15]=[o(" Update Password ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};typeof k=="function"&&k(R);const Ee=h(R,[["__scopeId","data-v-092f1818"]]);export{Ee as default};
